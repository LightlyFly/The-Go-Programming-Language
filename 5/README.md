# 函数

- 函数包含连续的执行语句，可以在代码中通过调用函数来执行它们。

## 函数声明

每个函数都包含一个名字、一个形参列表、一个可选的返回列表以及函数体：

```go
func name(parameter-list) (result-list) {
  body
}
```

- 函数的类型称作函数签名。当两个函数拥有相同的形参列表和返回列表时，认为这两个函数的类型或签名是相同的。
- 每一次调用函数都需要提供实参来对应函数的每一个形参，包括参数的调用顺序也必须一致。Go 语言没有默认参数值的概念也不能指定实参名。
- 形参变量都是函数的局部变量，初始值由调用者提供的实参传递。函数形参以及命名返回值同属于函数最外层作用域的局部变量。
- 实参是按值传递的，所以函数接收到的是每个实参的副本；修改函数的形参变量并不会影响到调用者提供的实参。然而，如果提供的实参包含引用类型，比如指针、slice、map、函数或者通道，那么当函数使用形参变量时就有可能会间接地修改实参变量。
- 你可能偶尔会看到有些函数的声明没有函数体，那说明这个函数使用除了 Go 以外的语言实现。这样的声明定义了该函数的签名。

```go
package math 

func Sin(x float64) float64 // 使用汇编语言实现
```

## 递归

- 函数可以递归调用，这意味着函数可以直接或间接地调用自己。
- 许多编程语言使用固定长度的函数调用栈；大小在 64KB 到 2MB 之间。递归的深度受限于固定长度的栈大小，相比较固定长的栈，Go 语言的实现使用了可变长度的栈，栈的大小会随着使用而增长，可达到 1GB 左右的上限。这使得我们可以安全地使用递归而不用担心溢出问题。

## 多返回值

- 一个函数能够返回不止一个结果。
- 我们必须保证 resp.Body 正确关闭使得网络资源正常释放。即使在发送错误的情况下也必须释放资源。Go 语言的垃圾回收机制将回收未使用的内存，但不能指望它会释放未使用的操作系统资源，比如打开的文件以及网络连接。必须显式地关闭它们。
- 良好的名称可以使得返回值更加有意义。尤其在一个函数返回多个结果且类型相同时，名字的选择更加重要，比如：

```go
func Size(rect image.Rectangle) (width, height int)
func Split(path string) (dir, file string)
func HourMinSec(t time.Time) (hour, minute, second int)
```

- 一个函数如果有命名的返回值，可以省略 return 语句的操作数，这称为裸返回。
- 裸返回可以消除重复代码，但是并不能使代码更加易于理解，鉴于这个原因，应保守使用裸返回。

## 错误

- 对于许多函数而言，即使在高质量的代码中，也不能保证一定能够成功返回，因为有些因素并不受程序设计者的掌控。比如任何操作 I/O 的函数都一定会面对可能的错误，只有没有经验的程序员会认为一个简单的读或写不会失败。事实上，这些地方是我们最需要关注的，很多可靠的操作都可能会毫无征兆地发生错误。
- 一般当一个函数返回一个非空错误时，它其他的结果都是未定义的而且应该忽略。